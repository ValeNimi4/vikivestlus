<!DOCTYPE html>
<html>
<head>
<title>vikivestlus</title>
<style>.kasutaja {float: right;}
p, a, input {font-family: serif; font-size: 15px; color: white}
a:hover {text-decoration: underline}
input {all: unset; border: solid 2px white; padding: 0; height: 15px; border-radius: 0; background-color: black; color: white;font-family: serif;}
body {background-color: black; height: 100vh;}
a:visited, a:link, a{color: lightblue; text-decoration: none;}
.mittelink {background-color: lightblue; color: black !important;}
/*.new:hover, .new:focus {visibility: hidden;}*/</style>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div style="position: fixed; top: 0; right: 0;">
<a onclick="window.scrollTo({top:0, behavior: 'smooth'})">&uarr;</a><br>
<a onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})">&darr;</a>
</div>
<img src="vikiikoon.svg" height=20 style="position: fixed; top: 0; left: 0;">
<p id="tekst" style="margin: 20px 20px 100px 20px"><img src="vikivestlus_kiri.svg" height=20><br>Vikivestlus on mõeldud selleks, et saaksid suhelda nagu internetis sõpradega või tehisintellektiga, aga tegelikult otsid
<a href="https://et.wikipedia.org">vikipeediast</a>. See on kasulik, kui oled "haugi mäluga"<br>Selle lehe tegi <a href="/">valeNimi4</a><br>
Vajuta paremal olevale Sinu päritud artiklile suures vaates vaatamiseks. Vikivestlus kasutab Mediawiki Action API. Kui tahate kasutada teist Mediawikit (või kui sulle meeldib jamada) vajuta
<a onclick="document.getElementById('mediawiki').style.visibility = 'visible'">siia</a><br><input id="mediawiki" style="visibility: hidden" value="https://et.wikipedia.org">
</p>
<div style="width: calc(100% - 40px); height: 20px; position: fixed; bottom: 0; left:30px;"><input id="input" style="width: calc(100% - 55px)"><a class="mittelink" onclick="otsi(input.value)">&rarr;</a></div>
<script>
function otsi (otsing) {window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
fetch(mw.value+"/w/api.php?action=query&titles="+otsing+"&prop=extracts&format=json&exintro=1&explaintext=1&redirects=1&origin=*").then(vastus => {return vastus.json()}).then(info => {
  lehed = info.query.pages;
  html = Object.values(lehed)[0].extract;
  if (html) {
/*html = info.parse.text["*"];
html = html.replace(/<a\s+href="\/wiki\/([^"]+)"/g, (match, p1) => {
  return `<a href="#${p1}"`;
});
html = html.replaceAll("//", 'https://');
html = html.replaceAll("https:https://", 'https://');*/
tekst.innerHTML += '<br><a href="'+"rohkem.html#"+otsing+'" class="kasutaja mittelink">'+otsing+"</a><br>" + html; } else {tekst.innerHTML += '<br><a class="kasutaja mittelink">'+otsing+"</a><br>Artikkel ei eksisteeri!";}
input.value = "";}).catch(err => {tekst.innerHTML += '<br><a class="kasutaja mittelink">'+otsing+"</a><br>Viga! Kas netiühendus on olemas?"; console.log(err); input.value = "";})}
var html = "";
var input = document.getElementById("input");
var tekst = document.getElementById("tekst");
var mw = document.getElementById("mediawiki");
if (window.location.hash) {otsi(decodeURIComponent(window.location.hash).slice(1))}
input.addEventListener("keydown", function (event) { if (event.key == "Enter") {otsi(input.value)}});
window.addEventListener('hashchange', function (event) {otsi(decodeURIComponent(window.location.hash).slice(1))})
</script>
</body>
</html>
